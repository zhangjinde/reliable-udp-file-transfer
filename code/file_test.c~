#include <stdio.h>


int main()
{
  FILE * pFile;

  pFile = fopen("data1M.bin" , "rb" );
  if (pFile==NULL) {fputs("File error\n",stderr); exit(1);}

  fseek (pFile , 0 , SEEK_END);
  lSize = ftell (pFile);
  rewind (pFile);
  printf("File Size: %ld\n", lSize);
  chunks = ceil(lSize/(float)data_size);
  // allocate memory to contain the whole file:
  char **buffer = (char**) malloc (chunks*sizeof(char*));
  int count = 0;

  /// reading from file
  for(count = 0; count < chunks - 1;count++)
    {
      buffer[count] = (char*) malloc (data_size*sizeof(char));
      result = fread (buffer[count], 1, data_size, pFile);
    } 
  printf("No of chunks : %d\n", chunks);
  printf("Max file size : %ld\n", lSize);
  printf("Memory read : %d\n", (chunks - 1)*data_size);
  printf("Memory left to read : %ld\n", lSize - (chunks-1)*data_size);
  printf("count value  : %d\n", count);
  
  
  /// remaining memory chunk lSize - chunks*data_size
  final_chunk = lSize - (chunks-1)*data_size;
  
  buffer[count] = (char*) malloc (final_chunk*sizeof(char));
  result = fread (buffer[count],1,final_chunk,pFile);
  printf("File Size read: %d, count : %d\n", result,count);


  fclose (pFile);


  return 0;
}
